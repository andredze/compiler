CC = g++
CFLAGS = -g -Wcast-qual -Wconversion -Wctor-dtor-privacy							 \
		 -Wempty-body -Wformat-security -Wformat=2 -Wignored-qualifiers -Wlogical-op \
         -Wno-missing-field-initializers -Wnon-virtual-dtor -Woverloaded-virtual     \
		 -Wpointer-arith -Wsign-promo -Wstack-usage=8192 -Wstrict-aliasing           \
		 -Wstrict-null-sentinel -Wtype-limits -Wwrite-strings -fexceptions -pipe

CFLAGS += -I include -I ../common/lang_ctx -I ../common/stack -I ../common/colors -I ../common/tree -I ../common

COMMONS_OBJ		= ../commons/obj
SOURCES_DIR   	= src
OBJECTS_DIR   	= obj

LOGS_DIR 	  	= log

EXECUTABLE 	    = frontend
EXECUTABLE_PATH = $(EXECUTABLE)

SOURCE_FILES         = $(wildcard $(SOURCES_DIR)/*.cpp)
OBJECT_FILES         = $(subst $(SOURCES_DIR), $(OBJECTS_DIR), $(SOURCE_FILES:.cpp=.o))
COMMONS_OBJ_FILES 	 = $(wildcard $(COMMONS_OBJ)/*.o)

all: $(EXECUTABLE_PATH)

$(OBJECTS_DIR):
	mkdir -p $(OBJECTS_DIR)
	mkdir -p $(LOGS_DIR)

$(EXECUTABLE_PATH): $(OBJECT_FILES) $(BUILD_DIR)
	$(CC) $(COMMONS_OBJ_FILES) $(OBJECT_FILES) -o $@

$(OBJECTS_DIR)/%.o: $(SOURCES_DIR)/%.cpp $(OBJECTS_DIR)
	$(CC) -c $(CFLAGS) $< -o $@

clean_logs:
	rm $(DOT_FILES_DIR)/*.dot $(IMAGES_DIR)/*.png

clean:
	rm -fr $(OBJECTS_DIR)
